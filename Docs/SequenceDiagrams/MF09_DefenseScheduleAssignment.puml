@startuml
title MF09 - Defense Schedule Assignment with Eligibility Check

actor GraduationThesisManager
participant DefenseScheduleController
participant DefenseScheduleService
participant ReviewResultService
database DefenseSchedule
database ReviewAssignment

GraduationThesisManager -> DefenseScheduleController : assignDefenseSchedule(groupId)

DefenseScheduleController -> ReviewResultService : getReviewStatus(groupId)
ReviewResultService -> ReviewAssignment : fetch(groupId)
ReviewAssignment --> ReviewResultService : reviewRecords
alt All students passed
  ReviewResultService -> DefenseScheduleService : proceed to schedule(groupId)
  DefenseScheduleService -> DefenseSchedule : create(scheduleData)
  DefenseSchedule --> DefenseScheduleService : scheduleCreated
  DefenseScheduleService -> DefenseScheduleController : scheduleConfirmed
else Some failed
  DefenseScheduleController -> GraduationThesisManager : reject with reason
end
@enduml